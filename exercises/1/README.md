### Zadanie 1

#### Model ERD

<img src="https://github.com/pawlowskaanna/sandbox-sql/blob/master/exercises/1/pictures/z1.2.png" width="500" >


#### Model fizyczny

<img src="https://github.com/pawlowskaanna/sandbox-sql/blob/master/exercises/1/pictures/z1.png" width="800" >


#### SQL DDL

    -- SQL DDL
    
    
    -- Creating COMPONENTS table with primary key: COMPONENT_CODE with additional CONSTRAINT CHECK (CONSTRAINT col_name CHECK (col IN (...)))

    CREATE TABLE Z1.COMPONENTS 
    (	
    "COMPONENT_CODE" number(10,0) NOT NULL,
    "NAME"      VARCHAR2(50 char) NOT NULL,
    "WEIGHT"    NUMBER(7,3) NOT NULL,
    "AVAILABILITY"  VARCHAR2(20), 
    CONSTRAINT PK_COMPONENTS PRIMARY KEY(COMPONENT_CODE),
    CONSTRAINT CHK_AVAILABILITY CHECK (AVAILABILITY IN ('avaliable', 'unavaliable', 'running out'))
    );
    
     -- Creating STRUCTURAL_ELEMENTS table with primary key: ELEMENT_CODE
     
    CREATE TABLE Z1.STRUCTURAL_ELEMENTS 
    (	
    "ELEMENT_CODE"  nchar(10) NOT NULL,
    "NAME"          varchar(20) NOT NULL,
    "ELEMENT_DESCRIPTION"          varchar(20),
    "ENTRY"         date NOT NULL,
    "ARCH"          date,
    "WEIGHT"        number(7,3) NOT NULL,
    CONSTRAINT PK_STRUCTURAL_ELEMENTS PRIMARY KEY(ELEMENT_CODE)
    );
    
    
     -- Creating ELEMENT_COMPONENTS table with primary key: COMPONENT_KODE, ELEMENT_CODE

    CREATE TABLE Z1.ELEMENT_COMPONENTS 
    (	
    "ELEMENT_CODE"  nchar(10) NOT NULL,
    "COMPONENT_CODE" number(10,0) NOT NULL,
    CONSTRAINT FK_COMPONENTS FOREIGN KEY(COMPONENT_CODE) REFERENCES Z1.COMPONENTS(COMPONENT_CODE),
    CONSTRAINT FK_STRUCTURAL_ELEMENTS FOREIGN KEY(ELEMENT_CODE) REFERENCES Z1.STRUCTURAL_ELEMENTS(ELEMENT_CODE),
    CONSTRAINT PK_ELEMENT_COMPONENTS PRIMARY KEY(COMPONENT_CODE, ELEMENT_CODE)
    );

#### SQL DML

:rocket: Inserting Components ( COMPONENTS )    
    
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6101010001', 'E10x10', '0000,015', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6201510001', 'F15x10', '0000,025', 'unavaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('990010035', 'ISKF10x35', '0000,040', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('990014035', 'ISKF14x35', '0000,045', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6000000022', 'GL22standard', '0000,020', 'running out');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6000000032', 'GL32standard', '0000,030', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6000030032', 'GL32spec', '0000,035', 'unavaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6104040001', 'E40x40', '0000,050', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6104545001', 'E45x45', '0000,050', 'unavaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('6201510001', 'F15x10', '0000,025', 'unavaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('8021111013', 'ISKA013', '0000,004', 'avaliable');
    INSERT INTO Z1.COMPONENTS (COMPONENT_CODE, NAME, WEIGHT, AVAILABILITY) VALUES ('8021111013', 'ISKA013', '0000,004', 'avaliable');
    
:airplane: Inserting Elements ( STRUCTURAL ELEMENTS )

    INSERT INTO Z1.STRUCTURAL_ELEMENTS (ELEMENT_CODE, NAME, ELEMENT_DESCRIPTION, ENTRY, WEIGHT) VALUES ('SCAF/PL/01', 'SCAFFOLD01', 'Scaffold,Poland,v01', TO_DATE('31-01-2019', 'DD-MM-YYYY'),'250,5');
    INSERT INTO Z1.STRUCTURAL_ELEMENTS (ELEMENT_CODE, NAME, ELEMENT_DESCRIPTION, ENTRY, WEIGHT) VALUES ('RACK/PL/11','RACK01S1','rack,v01,size1', TO_DATE('15-03-2019', 'DD-MM-YYYY'),'130,0');
    INSERT INTO Z1.STRUCTURAL_ELEMENTS (ELEMENT_CODE, NAME, ELEMENT_DESCRIPTION, ENTRY, WEIGHT) VALUES ('RACK/PL/12','RACK01S2','rack,v01,size2', TO_DATE('21-06-2019', 'DD-MM-YYYY'),'180,0');
  
:helicopter: Creating relationships between Elements and Components ( ELEMENT_COMPONENTS )

    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('SCAF/PL/01','6101010001');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('SCAF/PL/01','990010035');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('SCAF/PL/01','6000000022');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('SCAF/PL/01','6104040001');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('SCAF/PL/01','6104545001');
    
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/11','6201510001');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/11','6000000022');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/11','8021111020');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/11','6000030032');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/11','6104040001');
    
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/12','6101010001');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/12','6201510001');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/12','6000000022');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/12','6000030032');
    INSERT INTO ELEMENT_COMPONENTS (ELEMENT_CODE, COMPONENT_CODE) VALUES ('RACK/PL/12','8021111013');



#### SQL Queries

##### 1. Easy
Select all components whose code begins with '6' and are heavier than 10 gramms. Sort results from heaviest to lightest (hint: user ORDER BY over column WEIGHT with proper ASC/DESC switch ). Please make sure you display weight as shown in the picture.

<img src="https://github.com/pawlowskaanna/sandbox-sql/blob/master/exercises/1/pictures/z1.q1.png" width="200" >

    -- Solution SQL
    
    SELECT NAME, SUBSTR(RPAD(WEIGHT, 4 ,'0') , -2) || 'g' "WEIGHT"  
    FROM COMPONENTS
    WHERE COMPONENT_CODE LIKE '6%'
    ORDER BY WEIGHT desc;
    

    
##### 2. Intermediate
Select all elements and their components. Display only element name and component name. Name the columns as shown in picture and sort results by element name and component name.  

<img src="https://github.com/pawlowskaanna/sandbox-sql/blob/master/exercises/1/pictures/z1.q2.png" width="250" >

    -- Solution SQL
    
    SELECT SE.NAME "ELEMENT_NAME" , C.NAME "COMPONENT_NAME" FROM Z1.ELEMENT_COMPONENTS 
    JOIN COMPONENTS C ON C.COMPONENT_CODE = ELEMENT_COMPONENTS.COMPONENT_CODE
    JOIN STRUCTURAL_ELEMENTS SE ON SE.ELEMENT_CODE = ELEMENT_COMPONENTS.ELEMENT_CODE
    ORDER BY 1,2;
    
##### 3. Difficult
Display number of components for each element (hint: use function COUNT and GROUP BY clause). Display summarized components weight in gramms as shown in figure (hint: use function SUM and GROUP BY clause).

<img src="https://github.com/pawlowskaanna/sandbox-sql/blob/master/exercises/1/pictures/z1q3.png" width="350" >

    -- Solution SQL
    
    SELECT SE.NAME "ELEMENT_NAME" , 
    COUNT (C.COMPONENT_CODE)"COMPONENTS" , SUM(C.WEIGHT)*1000 || 'g' AS COMPONENTS_WEIGHT
    FROM Z1.ELEMENT_COMPONENTS 
    JOIN STRUCTURAL_ELEMENTS SE ON SE.ELEMENT_CODE = ELEMENT_COMPONENTS.ELEMENT_CODE
    JOIN COMPONENTS C ON C.COMPONENT_CODE = ELEMENT_COMPONENTS.COMPONENT_CODE
    GROUP BY SE.NAME;
